{
  "hash": "6fc69e611954dc502ee84a16a9b88d54",
  "result": {
    "markdown": "---\ntitle: \"Difference Scores_Basic Example\"\nformat: html\neditor: source\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# Install necessary packages (if not already installed)\nif (!(\"lme4\" %in% installed.packages())) install.packages(\"lme4\")\nif (!(\"lmerTest\" %in% installed.packages())) install.packages(\"lmerTest\")\nif (!(\"tidyverse\" %in% installed.packages())) install.packages(\"tidyverse\")\nif (!(\"ggpubr\" %in% installed.packages())) install.packages(\"ggpubr\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Load packages\nlibrary(lme4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: Matrix\n```\n:::\n\n```{.r .cell-code}\nlibrary(lmerTest)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'lmerTest'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:lme4':\n\n    lmer\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:stats':\n\n    step\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages\n───────────────────────────────────────\ntidyverse 1.3.2 ──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ ggplot2 3.4.0      ✔ purrr   1.0.0 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.5.0 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ tidyr::expand() masks Matrix::expand()\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n✖ tidyr::pack()   masks Matrix::pack()\n✖ tidyr::unpack() masks Matrix::unpack()\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggpubr)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_wide<- read_csv(\"./df_wide.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 5649 Columns: 27\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (1): ids\ndbl (26): SiteID, FamilyID, Sex, Age, Race_White, Race_Black, Race_Hispanic,...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nstr(df_wide)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nspc_tbl_ [5,649 × 27] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ ids                   : chr [1:5649] \"NDAR_INV003RTV85\" \"NDAR_INV00CY2MDM\" \"NDAR_INV00HEV6HB\" \"NDAR_INV00LH735Y\" ...\n $ SiteID                : num [1:5649] 7 21 13 4 12 5 18 7 20 17 ...\n $ FamilyID              : num [1:5649] 7232 4495 1918 4973 6826 ...\n $ Sex                   : num [1:5649] 1 2 2 2 2 1 2 1 1 2 ...\n $ Age                   : num [1:5649] 10 10 10 9 10 10 9 9 10 10 ...\n $ Race_White            : num [1:5649] 1 1 0 0 0 0 1 1 1 1 ...\n $ Race_Black            : num [1:5649] 0 0 1 0 0 0 0 0 0 0 ...\n $ Race_Hispanic         : num [1:5649] 0 0 0 1 0 0 0 0 0 0 ...\n $ Race_Asian            : num [1:5649] 0 0 0 0 0 0 0 0 0 0 ...\n $ Race_Other            : num [1:5649] 0 0 0 0 1 1 0 0 0 0 ...\n $ ParentIncome          : num [1:5649] 5 6 999 4 1 6 7 8 9 7 ...\n $ ParentEducation       : num [1:5649] 13 15 13 13 11 12 19 21 18 18 ...\n $ IQ                    : num [1:5649] 51 40 52 40 36 49 999 63 19 44 ...\n $ FlankerTest           : num [1:5649] 52 51 40 39 44 34 999 40 30 38 ...\n $ PubertalDevelopment_F : num [1:5649] 3 999 999 999 999 999 999 1 4 999 ...\n $ PubertalDevelopment_M : num [1:5649] 999 2 3 1 3 999 2 999 999 2 ...\n $ MatureVideoGames      : num [1:5649] 1 1 2 1 2 1 1 1 1 1 ...\n $ Weekly_Gaming_Hours_T0: num [1:5649] 7 7 3.5 11 28 28 1.75 4.5 10.5 2.25 ...\n $ Weekly_Gaming_Hours_T1: num [1:5649] 7 9 28 28 4 3 7 7 8 9 ...\n $ Weekly_Gaming_Hours_T2: num [1:5649] 7 7 28 11 18 0 0 2 0 28 ...\n $ Aggression_T0         : num [1:5649] 0 15 5 2 14 17 0 5 0 5 ...\n $ Aggression_T1         : num [1:5649] 0 18 5 2 9 18 0 8 10 0 ...\n $ Aggression_T2         : num [1:5649] 999 20 9 3 8 999 0 999 6 1 ...\n $ Externalizing_T0      : num [1:5649] 1 18 7 2 20 21 0 7 0 5 ...\n $ Externalizing_T1      : num [1:5649] 1 22 10 2 12 25 0 10 12 0 ...\n $ Externalizing_T2      : num [1:5649] 999 25 14 3 11 999 0 999 7 1 ...\n $ Internalizing_T0      : num [1:5649] 1 5 6 4 2 17 0 5 4 4 ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   ids = col_character(),\n  ..   SiteID = col_double(),\n  ..   FamilyID = col_double(),\n  ..   Sex = col_double(),\n  ..   Age = col_double(),\n  ..   Race_White = col_double(),\n  ..   Race_Black = col_double(),\n  ..   Race_Hispanic = col_double(),\n  ..   Race_Asian = col_double(),\n  ..   Race_Other = col_double(),\n  ..   ParentIncome = col_double(),\n  ..   ParentEducation = col_double(),\n  ..   IQ = col_double(),\n  ..   FlankerTest = col_double(),\n  ..   PubertalDevelopment_F = col_double(),\n  ..   PubertalDevelopment_M = col_double(),\n  ..   MatureVideoGames = col_double(),\n  ..   Weekly_Gaming_Hours_T0 = col_double(),\n  ..   Weekly_Gaming_Hours_T1 = col_double(),\n  ..   Weekly_Gaming_Hours_T2 = col_double(),\n  ..   Aggression_T0 = col_double(),\n  ..   Aggression_T1 = col_double(),\n  ..   Aggression_T2 = col_double(),\n  ..   Externalizing_T0 = col_double(),\n  ..   Externalizing_T1 = col_double(),\n  ..   Externalizing_T2 = col_double(),\n  ..   Internalizing_T0 = col_double()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n```\n:::\n\n```{.r .cell-code}\nhist(df_wide$Externalizing_T0)\n```\n\n::: {.cell-output-display}\n![](Difference-Scores_Basic-Example_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Compute difference score based on CBCL Externalizing subscale scores at baseline (t1) and 1-Year Follow-up (t2)\ndf_wide$diffscore = df_wide$Externalizing_T1 - df_wide$Externalizing_T0\n\n#Compute statistical summaries for the difference score variable\nsummary(df_wide$diffscore)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-998.000   -2.000    0.000    1.498    1.000  999.000 \n```\n:::\n\n```{.r .cell-code}\n#Scatterplot to visualize relationship between t1 & t2 data used to create difference score\nscatterplot <- ggplot (df_wide, aes(x = Externalizing_T0, y = Externalizing_T1)) + geom_point(size = 3) + geom_smooth(method = lm, se = F) +\nxlab(\"CBCL Externalizing (x) Baseline\") +\nylab(\"CBCL Externalizing (x) 1-Year Follow-up\")\n\nsuppressWarnings(print(scatterplot))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Difference-Scores_Basic-Example_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#One-sample t-test to determine whether the average difference score is significantly different than 0.\nresult <- t.test(df_wide$diffscore, mu = 0, alternative = \"two.sided\")\n# Print the results\nresult \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne Sample t-test\n\ndata:  df_wide$diffscore\nt = 2.4509, df = 5648, p-value = 0.01428\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 0.2997325 2.6954879\nsample estimates:\nmean of x \n  1.49761 \n```\n:::\n\n```{.r .cell-code}\n#boxplot\nlibrary(ggpubr)\ndiffscore_boxplot <- ggboxplot(df_wide$diffscore, \n          ylab = \"Externalizing Difference Score\", xlab = FALSE,\n          ggtheme = theme_minimal())\n\nsuppressWarnings(print(diffscore_boxplot))\n```\n\n::: {.cell-output-display}\n![](Difference-Scores_Basic-Example_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Shapiro-Wilk test and normality (Q-Q) plot (visualization of correlation between a given sample and the normal distribution)\nshapiro.test(df_wide$diffscore[0:5000])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  df_wide$diffscore[0:5000]\nW = 0.057242, p-value < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nlibrary(\"ggpubr\")\nqqplot <- ggqqplot(df_wide$diffscore, \n         ylab = \"Externalizing Difference Score\", xlab = FALSE,\n         ggtheme = theme_minimal())\n\nsuppressWarnings(print(qqplot))\n```\n\n::: {.cell-output-display}\n![](Difference-Scores_Basic-Example_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Difference-Scores_Basic-Example_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}